// You don't need to remove past events; they are automatically hidden
// with JS.
e = [
  {
    "date": [2016, 10, 16],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/1798408000395535/",
    "html": "<table><tr><td>5:30-6:30:<td>family dance + open band<tr><td>6:30-7:30:<td>potluck dinner<tr><td>7:30-10:30:&nbsp;&nbsp;<td>contra dance</table>"
  },
  {
    "date": [2016, 11, 4],
    "title": "Cancelled: Tunes Jam",
    "link": "https://www.facebook.com/events/123715564767129/"
  },
  {
    "date": [2016, 11, 6],
    "title": "Contra + French Dance",
    "link": "https://www.facebook.com/events/181402685648008/"
  },
  {
    "date": [2016, 11, 20],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/346343689032967/"
  },
  {
    "date": [2016, 12, 4],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/1806816232868181/"
  },
  {
    "date": [2016, 12, 9],
    "title": "Tunes Jam",
    "link": "https://www.facebook.com/events/1287519351307009/"
  },
  {
    "date": [2016, 12, 18],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/1740016379583446/",
    "html": "<table><tr><td>5:30-6:30:<td>family dance + open band<tr><td>6:30-7:30:<td>potluck dinner<tr><td>7:30-10:30:&nbsp;&nbsp;<td>contra dance</table>"
  },
  {
    "date": [2017, 1, 1],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/255786891503916/",
    "html": "<i>Note: different time and place</i><p>6:30-9:30 at the Somerville Armory"
  },
  {
    "date": [2017, 1, 13],
    "title": "Cancelled: Tunes Jam",
    "link": "https://www.facebook.com/events/1313002352085987/"
  },
  {
    "date": [2017, 1, 15],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/148208402326176/",
    "html": "<table><tr><td>5:30-6:30:<td>family dance + open band<tr><td>6:30-7:30:<td>potluck dinner<tr><td>7:30-10:30:&nbsp;&nbsp;<td>contra dance    </table>"
  },
  {
    "date": [2017, 2, 5],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/831361257003881/"
  },
  {
    "date": [2017, 2, 19],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/426059384451810/"
  },
  {
    "date": [2017, 3, 5],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1609587239062879/"
  },
  {
    "date": [2017, 3, 19],
    "title": "Contra + Chestnuts Dance",
    "link": "https://www.facebook.com/events/1371900869527382/",
    "html": "A 'chestnut' in contra dancing   is a much beloved older dance, often with a particular musical   pairing&mdash;and we're going to mix some of these great classics into   your regularly scheduled programming."
  },
  {
    "date": [2017, 4, 2],
    "title": "Contra + Family Dance + Annual Meeting",
    "link": "https://www.facebook.com/events/1631926847113243/"
  },
  {
    "date": [2017, 4, 16],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/441175372893957/"
  },
  {
    "date": [2017, 5, 7],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/688848671298246/"
  },
  {
    "date": [2017, 5, 21],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/1433770406643381/"
  },
  {
    "date": [2017, 6, 4],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1474332579253848/"
  },
  {
    "date": [2017, 6, 18],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/433674550321262/"
  },
  {
    "date": [2017, 6, 23],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/654557714752091/"
  },
  {
    "date": [2017, 7, 2],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1790822677914717/"
  },
  {
    "date": [2017, 7, 16],
    "title": "Contra + Family Dance at the Somerville Armory",
    "link": "https://www.facebook.com/events/2021926354695006/"
  },
  {
    "date": [2017, 8, 6],
    "title": "Contra Dance at the Somerville Armory",
    "link": "https://www.facebook.com/events/1105120249621663/"
  },
  {
    "date": [2017, 8, 11],
    "title": "Tunes Jam",
    "link": "https://www.facebook.com/events/137742760155377/"
  },
  {
    "date": [2017, 8, 20],
    "title": "Contra + Family Dance at the Somerville Armory",
    "link": "https://www.facebook.com/events/118059022142416"
  },
  {
    "date": [2017, 9, 3],
    "title": "Contra Dance, back at the Cambridge Masonic Hall",
    "link": "https://www.facebook.com/events/983112241831661/"
  },
  {
    "date": [2017, 9, 17],
    "title": "*Free* Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/1952062901712111/"
  },
  {
    "date": [2017, 10, 1],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/619533791768595/"
  },
  {
    "date": [2017, 10, 11],
    "title": "Open Jam",
    "link": "https://www.facebook.com/events/1789481778017946/"
  },
  {
    "date": [2017, 10, 14],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/172577149957582/"
  },
  {
    "date": [2017, 10, 15],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/140875713196510/"
  },
  {
    "date": [2017, 11, 5],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/421968388205184/"
  },
  {
    "date": [2017, 11, 15],
    "title": "Bandleading Tunes Party",
    "link": "https://www.facebook.com/events/171598826757785/"
  },
  {
    "date": [2017, 11, 19],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1796605573745567/"
  },
  {
    "date": [2017, 12, 3],
    "title": "Contra Dance + Open Band + Open Bandleading",
    "link": "https://www.facebook.com/events/137094043715901/"
  },
  {
    "date": [2017, 12, 17],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1553620488053626/"
  },
  {
    "date": [2018, 1, 7],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/126007021502286/"
  },
  {
    "date": [2018, 1, 19],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/1705892206111550/"
  },
  {
    "date": [2018, 1, 21],
    "title": "Musician Workshop",
    "link": "https://www.facebook.com/events/117588775603713/"
  },
  {
    "date": [2018, 1, 21],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/181576835764899/",
    "html": "<table>      <tr><td>5:30-6:30:<td>family dance + open band      <tr><td>6:30-7:30:<td>potluck dinner      <tr><td>7:30-10:30:&nbsp;&nbsp;<td>contra dance    </table>"
  },
  {
    "date": [2018, 2, 4],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/216329382268471/"
  },
  {
    "date": [2018, 2, 18],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/137036173774460/"
  },
  {
    "date": [2018, 2, 28],
    "title": "Open Jam",
    "link": "https://www.facebook.com/events/1907473139565268/"
  },
  {
    "date": [2018, 3, 4],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/1190093874460046/"
  },
  {
    "date": [2018, 3, 18],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/358601874635881/"
  },
  {
    "date": [2018, 4, 1],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/357125214785936/"
  },
  {
    "date": [2018, 4, 4],
    "title": "Introductory Sound Workshop",
    "link": "https://www.facebook.com/events/1106142452859553/"
  },
  {
    "date": [2018, 4, 9],
    "title": "Introductory Sound Workshop",
    "link": "https://www.facebook.com/events/1106142452859553/"
  },
  {
    "date": [2018, 4, 15],
    "title": "Contra Dance + Annual Meeting",
    "link": "https://www.facebook.com/events/549715282076651/"
  },
  {
    "date": [2018, 5, 6],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/574033382970439/"
  },
  {
    "date": [2018, 5, 16],
    "title": "Pre-Open Band Jam",
    "link": "https://www.facebook.com/events/396232334176796/"
  },
  {
    "date": [2018, 5, 20],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/620538981614020/"
  },
  {
    "date": [2018, 6, 3],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/237170377052016/"
  },
  {
    "date": [2018, 6, 17],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/197904014181224/"
  },
  {
    "date": [2018, 6, 22],
    "title": "Sparkle",
    "link": "https://www.facebook.com/events/167617197250098/"
  },
  {
    "date": [2018, 7, 1],
    "title": "Last Contra Dance until September",
    "link": "https://www.facebook.com/events/171184873570116/"
  },
  {
    "date": [2018, 9, 2],
    "title": "First Contra Dance of Fall",
    "link": "https://www.facebook.com/events/2144325189183937/"
  },
  {
    "date": [2018, 9, 16],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/461154714404261/"
  },
  {
    "date": [2018, 9, 29],
    "title": "Sparkle",
    "link": "https://www.facebook.com/events/486209035188271/"
  },
  {
    "date": [2018, 10, 7],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/2299154823680259/"
  },
  {
    "date": [2018, 10, 19],
    "title": "Open Bandleading Party",
    "link": "https://www.facebook.com/events/438391453353775/"
  },
  {
    "date": [2018, 10, 21],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/2161173014208463/"
  },
  {
    "date": [2018, 10, 26],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/1989692144440783/"
  },
  {
    "date": [2018, 11, 4],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/326732104796681/"
  },
  {
    "date": [2018, 11, 18],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/176641616620025/"
  },
  {
    "date": [2018, 12, 2],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/333991700763628/"
  },
  {
    "date": [2018, 12, 14],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/277254516259723/"
  },
  {
    "date": [2018, 12, 16],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/291062938411154/"
  },
  {
    "date": [2019, 1, 6],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/226105528314855/"
  },
  {
    "date": [2019, 1, 20],
    "title": "Cancelled: Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/940230436169392/"
  },
  {
    "date": [2019, 2, 3],
    "title": "10th Anniversary Contra Dance",
    "link": "https://www.facebook.com/events/223886658537789/"
  },
  {
    "date": [2019, 2, 17],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/352836972112394/"
  },
  {
    "date": [2019, 3, 3],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/789992681362941/"
  },
  {
    "date": [2019, 3, 17],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/309714253022042/"
  },
  {
    "date": [2019, 3, 22],
    "title": "Contra Dance Weekend: Beantown Stomp",
    "link": "https://www.facebook.com/events/2170366253251724/"
  },
  {
    "date": [2019, 3, 29],
    "title": "Introductory Sound Workshop",
    "link": "https://www.facebook.com/events/390410001514090/"
  },
  {
    "date": [2019, 4, 1],
    "title": "Introductory Sound Workshop",
    "link": "https://www.facebook.com/events/390410001514090/"
  },
  {
    "date": [2019, 4, 7],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/1321464138001152/"
  },
  {
    "date": [2019, 4, 19],
    "title": "Sparkle (Harvard Square)",
    "link": "https://www.facebook.com/events/344495839504202/"
  },
  {
    "date": [2019, 4, 21],
    "title": "Contra Dance + Annual Meeting",
    "link": "https://www.facebook.com/events/2271306433085893/"
  },
  {
    "date": [2019, 5, 5],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/340571863237617/"
  },
  {
    "date": [2019, 5, 19],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/520312035168646/"
  },
  {
    "date": [2019, 6, 2],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/371811596771389/"
  },
  {
    "date": [2019, 6, 16],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/415538668998430/"
  },
  {
    "date": [2019, 7, 7],
    "title": "Last Contra Dance of the Season",
    "link": "https://www.facebook.com/events/2295383910530999/"
  },
  {
    "date": [2019, 9, 1],
    "title": "First Contra Dance of the Season",
    "link": "https://www.facebook.com/events/3489870864371713/"
  },
  {
    "date": [2019, 9, 15],
    "title": "Contra + Family Dance + Open Band",
    "link": "https://www.facebook.com/events/486403805251034/"
  },
  {
    "date": [2019, 9, 29],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/375177783410452/"
  },
  {
    "date": [2019, 10, 6],
    "title": "Contra + Advanced Dance",
    "link": "https://www.facebook.com/events/2394062140916848/"
  },
  {
    "date": [2019, 10, 20],
    "title": "Contra + Family Dance",
    "link": "https://www.facebook.com/events/2275068329271838/"
  },
  {
    "date": [2019, 11, 3],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/510653343121672/"
  },
  {
    "date": [2019, 11, 17],
    "title": "Contra Dance"
  },
  {
    "date": [2019, 12, 1],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/2661022750624285/"
  },
  {
    "date": [2019, 12, 15],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/2510781078977234/"
  },
  {
    "date": [2020, 1, 5],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/586946245417632/"
  },
  {
    "date": [2020, 1, 13],
    "title": "Jamming Party",
    "link": "https://www.facebook.com/events/1016912412004342/"
  },
  {
    "date": [2020, 1, 19],
    "title": "Contra Dance + Scottish Ceilidh + Family Dance",
    "link": "https://www.facebook.com/events/2374783312742180/"
  },
  {
    "date": [2020, 2, 2],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/595205404610424/"
  },
  {
    "date": [2020, 2, 16],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/468964767121011/"
  },
  {
    "date": [2020, 3, 1],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/2491609797773348/"
  },
  {
    "date": [2020, 3, 15],
    "title": "CANCELLED: Contra Dance",
    "link": "https://www.facebook.com/events/172932543914445/"
  },
  {
    "date": [2020, 3, 16],
    "title": "CANCELLED: Jamming Party",
    "link": "https://www.facebook.com/events/1533057363536403/"
  },
  {
    "date": [2020, 3, 20],
    "title": "CANCELLED: Contra Dance Weekend: Beantown Stomp",
    "link": "https://www.beantownstomp.com"
  },
  {
    "date": [2020, 4, 5],
    "title": "CANCELLED: Contra Dance + Family Dance"
  },
  {
    "date": [2021, 1, 29],
    "title": "Online Jam",
    "link": "https://www.facebook.com/events/236920641372232/"
  },
  {
    "date": [2022, 2, 20],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/3041007029484801/"
  },
  {
    "date": [2022, 3, 6],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/1166550917082275/"
  },
  {
    "date": [2022, 3, 20],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/316871777091759/"
  },
  {
    "date": [2022, 4, 3],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/1662515587469007"
  },
  {
    "date": [2022, 4, 17],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/1377776709395062/"
  },
  {
    "date": [2022, 5, 1],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/758001815584715/"
  },
  {
    "date": [2022, 5, 12],
    "title": "Jamming Party",
    "link": "https://www.facebook.com/events/3088876004658524/"
  },
  {
    "date": [2022, 5, 15],
    "title": "Contra Dance + Open Band, mask and booster required",
    "link": "https://www.facebook.com/events/763012658194979/"
  },
  {
    "date": [2022, 6, 5],
    "title": "Contra Dance, mask and booster required"
  },
  {
    "date": [2022, 6, 19],
    "title": "Contra Dance, mask and booster required",
    "link": "https://www.facebook.com/events/346447690933790/"
  },
  {
    "date": [2022, 7, 3],
    "title": "Last Contra Dance of the Season, mask and booster required",
    "link": "https://www.facebook.com/events/380264407501751"
  },
  {
    "date": [2022, 8, 27],
    "title": "Spark in the Dark",
    "link": "https://www.facebook.com/events/362268546082712"
  },
  {
    "date": [2022, 9, 4],
    "title": "First Contra Dance of the Season",
    "link": "https://www.facebook.com/events/396172329297421"
  },
  {
    "date": [2022, 9, 18],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/617303813291957"
  },
  {
    "date": [2022, 10, 2],
    "title": "No dance: hall unavailable"
  },
  {
    "date": [2022, 10, 16],
    "title": "Contra Dance + Family Dance",
    "link": "https://www.facebook.com/events/1165551591005008/"
  },
  {
    "date": [2022, 11, 3],
    "title": "Jamming Party",
    "link": "https://www.facebook.com/events/610760840732706/"
  },
  {
    "date": [2022, 11, 6],
    "title": "Contra Dance + Open Band",
    "link": "https://www.facebook.com/events/460812685888603"
  },
  {
    "date": [2022, 11, 20],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/3005766286390240/"
  },
  {
    "date": [2022, 12, 4],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/514426030606590/"
  },
  {
    "date": [2022, 12, 18],
    "title": "No dance: hall unavailable"
  },
  {
    "date": [2023, 1, 1],
    "title": "Contra Dance"
  },
  {
    "date": [2023, 1, 15],
    "title": "Contra Dance",
    "link": "https://www.facebook.com/events/544939470921683/"
  },
  {
    "date": [2023, 2, 5],
    "caller": "Hannah Chamberlain",
    "band": "Daybreak Trio (Anna Patton, Naomi Morse, Owen Morrison)",
    "link": "https://www.facebook.com/events/2105142026349140",
  },
  {
    "date": [2023, 2, 19],
    "band": "Carol, Steve, and Len Bittenson, Debby Knight, and Ben Rechel",
    "caller": "Sue Rosen",
    "link": ["https://www.facebook.com/events/1152126988838194/", "https://www.meetup.com/bida-contra-dance/events/291536606/"],
  },
  {
    "date": [2023, 3, 5],
    "band": "Confluence (Nadine Dyskant-Miller &amp; Barbara Dyskant)",
    "caller": "Hannah Johlas",
    "link": ["https://www.facebook.com/events/2501663259971407/", "https://www.meetup.com/bida-contra-dance/events/291909567/"],
  },
  {
    "date": [2023, 3, 10],
    "title": "Contra Dance Weekend: Beantown Stomp",
    "link": "https://www.beantownstomp.com",
    "band": "Eloise &amp;Co. and River Road",
    "caller": "Lisa Greenleaf and Luke Donforth",
  },
  {
    "date": [2023, 3, 19],
    "band": "Truffle Creek: Lillian Chase, Cecily Mills, and Jonah Spear",
    "caller": "Dereck Kalish",
    "link": ["https://www.facebook.com/events/225262179908499/", "https://www.meetup.com/bida-contra-dance/events/292170917/"]
  },
  {
    "date": [2023, 3, 26],
    "title": "Special Dance Featuring Countercurrent",
    "band": "Countercurrent: Alex Sturbaum and Brian Lindsay",
    "caller": "Harris Lapiroff",
    "link": ["https://www.facebook.com/events/1284836469047062/", "https://www.meetup.com/bida-contra-dance/events/291685974/"]
  },
  {
    "date": [2023, 3, 27],
    "title": "Jamming Party",
    "link": "https://www.facebook.com/events/206449911986719"
  },
  {
    "date": [2023, 3, 30],
    "title": "Introductory Sound Workshop",
    "link": "https://www.facebook.com/events/5959580194136381/"
  },
  {
    "date": [2023, 4, 2],
    "title": "Contra Dance + Open Band",
    "band": "Alex Cumming leading an Open Band",
    "caller": "Bob Isaacs",
    "link": ["https://www.facebook.com/events/670004571794355/", "https://www.meetup.com/bida-contra-dance/events/292390815/"]
  },
  {
    "date": [2023, 4, 16],
    "title": "Contra Dance + Family Dance + Annual Meeting",
    "band": "SpringTide: Willy Clemetson, Elsie Gawler, Ethan Tischler",
    "caller": "Don Veino",
    "link": ["https://www.facebook.com/events/751389736363162", "https://www.meetup.com/bida-contra-dance/events/292711685/"]
  },
  {
    "date": [2023, 5, 7],
    "caller": "Andrew Stout",
    "band": "Ben Wetherbee, Ruth Rappaport + friends",
    "link":["https://www.facebook.com/events/1225258111711016", "https://www.meetup.com/bida-contra-dance/events/293006729/"]
  },
  {
    "date": [2023, 5, 21],
    "title": "Double Dance! Afternoon Advanced Dance, Potluck, & All-levels Evening Dance",
    "band": "Calluna: Eileen O'Grady, Gus Cantieni, & Jesse Ball",
    "caller": "Steve Zakon-Anderson",
    "link": ["https://www.facebook.com/events/787404699486706/", "https://www.meetup.com/bida-contra-dance/events/293428934/"],
    "html": "<table><tr><td>4:00-6:30<td>Advanced dance" +
      "             <tr><td>6:30-7:30<td>Potluck" +
      "             <tr><td>7:00-7:30<td>Beginner's Lesson" +
      "             <tr><td>7:30-10:30<td>Evening dance" +
      "      </table>" +
      "<p><dl><dt><i>What do you mean, advanced? Should I come??</i>" +
      "<dd><p>For the afternoon advanced session, Steve is going to be calling" +
      " some trickier material and teaching less than usual. If you are" + 
      " comfortable doing a no-walkthrough, you should be good!</dl>"
  },
  {
    "date": [2023, 6, 4],
    "band": "Rose Jackson, Rebecca Weiss, & Ann Percival",
    "caller": "Chloe Levine"
    "link": ["https://www.meetup.com/bida-contra-dance/events/293723280/", "https://www.facebook.com/events/1388514941881652", "https://www.instagram.com/p/CsmfFUarFm_/"]
  },
  {
    "date": [2023, 6, 18],
    "band": "Cojiro: Jess Newman, Mark Price",
  },
  {
    "date": [2023, 7, 2],
    "title": "So Long For Now Contra Dance - last dance of the 2022-2023 season",
  },
];

events = document.getElementById("events");
past_events = document.getElementById("past-events");

function getHostname(url) {
  var hostname = url.split('/')[2];
  if (hostname.slice(0,4) == "www.") {
    hostname = hostname.slice(4);
  }

  if (hostname == "facebook.com") {
    return "facebook";
  } else if (hostname == "meetup.com") {
    return "meetup";
  } else {
    return hostname;
  }
}

function gen_events() {
  var yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
  var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday",
              "Friday", "Saturday"];
  for (var i = 0; i < e.length; i++) {
    var event = e[i];

    event.date = new Date(
      event.date[0],
      event.date[1] - 1,
      event.date[2],
    )
    let links = null;
    if (event.link) {
      if (Array.isArray(event.link)) {
        links = event.link;
      } else {
        links = [event.link];
      }
    }
    if (links) {
      var event_a = document.createElement("a");
      event_a.href = links[0];
    }
    var event_div = document.createElement("div");
    event_div.className = "event";
    var date_div = document.createElement("div");
    date_div.className = "date";
    var date_text = days[event.date.getDay()] + " " +
                    (event.date.getMonth() + 1) + "/" +
                    event.date.getDate();
    if (event.date.getYear() != new Date().getYear()) {
      date_text += "/" + (event.date.getYear() + 1900);
    }
    date_div.textContent = date_text;
    event_div.appendChild(date_div);
    var details_div = document.createElement("div");
    details_div.className = "details";
    event.title = event.title || "Contra Dance";
    var title_div = document.createElement("div");
    title_div.className = "title";
    title_div.textContent = event.title;
    event_div.appendChild(title_div);
    if (event.html) {
      var event_custom_html = event.html + "<p>";
      var custom_html_div = document.createElement("div");
      custom_html_div.innerHTML = event_custom_html;
      details_div.appendChild(custom_html_div);
    }
    if (event.caller || event.band) {
      var performers_div = document.createElement("div");
      performers_div.className = "performers";
      if (!event.band) {
        performers_div.innerHTML = event.caller + " calling."
      } else if (!event.caller) {
        performers_div.innerHTML = event.band + " playing."
      } else {
        performers_div.innerHTML = event.caller + " calling to " + event.band;
      }
      details_div.appendChild(performers_div);
    }
    var links_div = document.createElement("div");
    if (links) {
      links_div.appendChild(document.createTextNode(" details on "));
      let is_first = true;
      links.forEach(link => {
        if (!is_first) {
          links_div.appendChild(document.createTextNode(", "));
        }
        const link_a = document.createElement("a");
        link_a.textContent = getHostname(link);
        link_a.href = link;
        link_a.className = "link";
        links_div.appendChild(link_a);
        is_first = false;
      })
    } else if (event.title.toLowerCase().startsWith("no dance")) {
      links_div.textContent ="Dance cancelled.";
    } else if (!event.caller && !event.band && !event.html){
      links_div.textContent ="details TBA";
    } else {
      links_div.style.display = "none";
    }
    details_div.appendChild(links_div);
    event_div.appendChild(details_div);
    clear_div = document.createElement("div");
    clear_div.className = "clear";
    event_div.appendChild(clear_div);
    var append_event = event_div;
    if (links) {
      event_a.appendChild(event_div);
      append_event = event_a;
    }

    if (event.date < yesterday) {
      if (past_events.children.length == 0) {
        past_events.appendChild(append_event);
      } else {
        past_events.insertBefore(
          append_event, past_events.firstChild);
      }
    } else {
      events.appendChild(append_event);
    }
  }
}
gen_events();

show_past = false;
toggle_past = document.getElementById("toggle-past");

function update_toggle_past() {
  if (show_past) {
    toggle_past.textContent = "Hide Past Events";
  } else {
    toggle_past.textContent = "Show Past Events";
  }
}

toggle_past.onclick = function() {
  show_past = !show_past;
  past_events.style.display = show_past ? "block" : "none";
  update_toggle_past();
  return false;
};

update_toggle_past();
